name: CI

# Controls when the action will run. 
on:
  push:
    branches: [ CI/CD ]

jobs:

  Create or update infrastructure:
    runs-on: ubuntu-latest
    steps:
      - name: pulumi-up
        uses: pulumi/actions@v1
        with: 
          command: up
        env: 
          PULUMI_ROOT: infastructure
          PULUMI_ACCESS_TOKEN: ${{ secrets.PULUMI_ACCESS_TOKEN }}
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        